(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{434:function(t,e,s){"use strict";s.r(e);var a=s(49),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"node新手课（13）用户信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node新手课（13）用户信息"}},[t._v("#")]),t._v(" node新手课（13）用户信息")]),t._v(" "),s("h2",{attrs:{id:"简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),s("p",[t._v("上节课我们讲了手机号登录，今天我们来讲展示用户信息接口。")]),t._v(" "),s("h2",{attrs:{id:"需求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#需求"}},[t._v("#")]),t._v(" 需求")]),t._v(" "),s("p",[t._v("用户查看自己的信息，如头像，昵称，手机号等。")]),t._v(" "),s("h2",{attrs:{id:"功能流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#功能流程"}},[t._v("#")]),t._v(" 功能流程")]),t._v(" "),s("p",[t._v("通过用户凭据 token 获取到用户 id，在数据库 user 表中找到用户记录，返回前端用户的昵称和手机号。")]),t._v(" "),s("h2",{attrs:{id:"代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[t._v("#")]),t._v(" 代码")]),t._v(" "),s("blockquote",[s("p",[t._v("routes/user.js")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("router.get('/me', auth,function (ctx, next) {\n  return userApi.me(ctx) \n})\n")])])]),s("blockquote",[s("p",[t._v("api/user.js")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("const me = async(ctx) => {\n    const userId = ctx.state.userId\n    const user = await userModel.getUserById(userId)\n    ctx.body = resp.setData(user)\n    return\n}\n")])])]),s("blockquote",[s("p",[t._v("model/usermodel.js")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('const getUserById = async(id)=>{\n    let sql = "select nickname,phone from user where id=?"\n    let user = await mysql.queryOne(sql,[id])\n    return user ? user : []\n}\n')])])]),s("h2",{attrs:{id:"运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行"}},[t._v("#")]),t._v(" 运行")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("GET http://localhost:3000/user/me\n\n")])])]),s("p",[t._v("响应数据")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('{\n    "message":"OK",\n    "data":{\n        "nickname":"昵称","phone":"13012341236"\n    }\n}\n')])])]),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("用户信息展示接口就讲完了，你掌握了吗？有问题欢迎到群里和志同道合的小伙伴一起交流。")]),t._v(" "),s("p",[t._v("下节课我们讲解修改用户信息，继续加油吧，Let's go！")])])}),[],!1,null,null,null);e.default=r.exports}}]);