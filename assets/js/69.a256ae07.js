(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{478:function(a,t,r){"use strict";r.r(t);var v=r(49),_=Object(v.a)({},(function(){var a=this,t=a.$createElement,r=a._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h1",{attrs:{id:"mysql面试（7）备份恢复类问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mysql面试（7）备份恢复类问题"}},[a._v("#")]),a._v(" mysql面试（7）备份恢复类问题")]),a._v(" "),r("h2",{attrs:{id:"备份方式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#备份方式"}},[a._v("#")]),a._v(" 备份方式")]),a._v(" "),r("ul",[r("li",[a._v("逻辑备份（DB 备份到文件）")]),a._v(" "),r("li",[a._v("物理备份（DB 备份到 DB）")]),a._v(" "),r("li",[a._v("全量备份和增量备份以及差异备份")])]),a._v(" "),r("h2",{attrs:{id:"常用备份工具"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#常用备份工具"}},[a._v("#")]),a._v(" 常用备份工具")]),a._v(" "),r("table",[r("thead",[r("tr",[r("th",[a._v("名称")]),a._v(" "),r("th",[a._v("特点")])])]),a._v(" "),r("tbody",[r("tr",[r("td",[a._v("mysqldump")]),a._v(" "),r("td",[a._v("最常用的逻辑备份工具，支持全量备份和条件备份")])]),a._v(" "),r("tr",[r("td",[a._v("mysqlpump")]),a._v(" "),r("td",[a._v("多线程逻辑备份工具，mysqldump 增强版本")])]),a._v(" "),r("tr",[r("td",[a._v("xtrabackup")]),a._v(" "),r("td",[a._v("InnoDB 在线物理备份工具，支持多线程和增量备份")])])])]),a._v(" "),r("h2",{attrs:{id:"mysqldump"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mysqldump"}},[a._v("#")]),a._v(" mysqldump")]),a._v(" "),r("h3",{attrs:{id:"优点"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[a._v("#")]),a._v(" 优点")]),a._v(" "),r("ul",[r("li",[a._v("备份结果为可读 SQL 文件，可用于跨版本跨平台恢复数据")]),a._v(" "),r("li",[a._v("备份文件尺寸小于物理备份，便于长时间存储")]),a._v(" "),r("li",[a._v("MySQL 发行版自带工具，无需安装第三方软件")])]),a._v(" "),r("h3",{attrs:{id:"缺点"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[a._v("#")]),a._v(" 缺点")]),a._v(" "),r("ul",[r("li",[a._v("只能单线程执行备份恢复任务，备份恢复速度较慢")]),a._v(" "),r("li",[a._v("为完成一致性备份需要对备份表加锁，容易造成阻塞")]),a._v(" "),r("li",[a._v("会对 Innodb Buffer Pool 造成污染")])]),a._v(" "),r("h2",{attrs:{id:"mysqlpump"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mysqlpump"}},[a._v("#")]),a._v(" mysqlpump")]),a._v(" "),r("h3",{attrs:{id:"优点-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#优点-2"}},[a._v("#")]),a._v(" 优点")]),a._v(" "),r("ul",[r("li",[a._v("语法同 mysqldump 高度兼容、学习成本低")]),a._v(" "),r("li",[a._v("支持基于库和表的并行备份，可以提高逻辑备份的性能")]),a._v(" "),r("li",[a._v("支持使用 ZLIB 和 Lz4 算法对备份进行压缩")])]),a._v(" "),r("h3",{attrs:{id:"缺点-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缺点-2"}},[a._v("#")]),a._v(" 缺点")]),a._v(" "),r("ul",[r("li",[a._v("基于表进行并行备份，对大表性能较差")]),a._v(" "),r("li",[a._v("5.7.11 之前版本不支持一致性并行备份")]),a._v(" "),r("li",[a._v("会对 Innodb Buffer Pool 造成污染")])]),a._v(" "),r("h2",{attrs:{id:"xtrabackup"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#xtrabackup"}},[a._v("#")]),a._v(" xtrabackup")]),a._v(" "),r("h3",{attrs:{id:"优点-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#优点-3"}},[a._v("#")]),a._v(" 优点")]),a._v(" "),r("ul",[r("li",[a._v("支持 innodb 存储引擎在线热备份，对 innodb 缓存没有影响")]),a._v(" "),r("li",[a._v("支持并行对数据库全量备份和增量备份")]),a._v(" "),r("li",[a._v("备份和恢复效率比逻辑备份高")])]),a._v(" "),r("h3",{attrs:{id:"缺点-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缺点-3"}},[a._v("#")]),a._v(" 缺点")]),a._v(" "),r("ul",[r("li",[a._v("单表恢复比较复杂")]),a._v(" "),r("li",[a._v("完成的数据文件拷贝，备份文件比逻辑备份大")]),a._v(" "),r("li",[a._v("对跨平台和数据库版本的备份恢复支持度不如逻辑备份")])]),a._v(" "),r("h2",{attrs:{id:"备份工具应用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#备份工具应用"}},[a._v("#")]),a._v(" 备份工具应用")]),a._v(" "),r("ul",[r("li",[a._v("逻辑备份 + 二进制日志")]),a._v(" "),r("li",[a._v("使用 xtrabackup 工具")])]),a._v(" "),r("h3",{attrs:{id:"xtrabackup-进行增量备份"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#xtrabackup-进行增量备份"}},[a._v("#")]),a._v(" xtrabackup 进行增量备份")]),a._v(" "),r("ul",[r("li",[a._v("全量备份 innobackupex --user=root --password=pwd /backups")]),a._v(" "),r("li",[a._v("增量备份 innobackupex --user=root --password=pwd --incremental /home/db_backup/ --incremental-basedir=/home/db_backup/back_dir")])]),a._v(" "),r("h3",{attrs:{id:"xtrabackup-进行增量恢复"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#xtrabackup-进行增量恢复"}},[a._v("#")]),a._v(" xtrabackup 进行增量恢复")]),a._v(" "),r("ul",[r("li",[a._v("innobackupex --apply-log --redo-only 全备目录")]),a._v(" "),r("li",[a._v("innobackupex --apply-log --redo-only 全备目录 --incremental-dir= 第 1... N 次增量目录")]),a._v(" "),r("li",[a._v("innobackupex --apply-log 全备目录")])]),a._v(" "),r("h2",{attrs:{id:"备份二进制日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#备份二进制日志"}},[a._v("#")]),a._v(" 备份二进制日志")]),a._v(" "),r("ul",[r("li",[a._v("cp 命令进行离线备份")]),a._v(" "),r("li",[a._v("mysqlbinlog 命令在线实时备份\n"),r("ul",[r("li",[a._v("mysqlbinlog --raw --read-from-remote-server --stop-never --host 备份 ip --port 端口 -u 用户名 -p 密码 启动二进制日志文件名")])])])]),a._v(" "),r("p",[a._v("用户具有 replication slave 权限")]),a._v(" "),r("h2",{attrs:{id:"欢迎扫描下方二维码，个人博客，持续关注："}},[r("a",{staticClass:"header-anchor",attrs:{href:"#欢迎扫描下方二维码，个人博客，持续关注："}},[a._v("#")]),a._v(" 欢迎扫描下方二维码，"),r("a",{attrs:{href:"https://www.phpst.cn",target:"_blank",rel:"noopener noreferrer"}},[a._v("个人博客"),r("OutboundLink")],1),a._v("，持续关注：")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://ww1.sinaimg.cn/large/a616b9a4gy1g4xzv954a4j20760763yo.jpg",alt:""}})]),a._v(" "),r("p",[a._v("互联网工程师（id:phpstcn），我们一起学习，一起进步")])])}),[],!1,null,null,null);t.default=_.exports}}]);