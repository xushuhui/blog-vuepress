(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{401:function(t,e,s){"use strict";s.r(e);var n=s(26),r=Object(n.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"node新手课（4）nodejs处理http请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node新手课（4）nodejs处理http请求"}},[t._v("#")]),t._v(" node新手课（4）nodejs处理http请求")]),t._v(" "),s("h2",{attrs:{id:"简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),s("p",[t._v("上节课我们成功用开启了一个 http 服务，写了个 helloworld，今天我们讲解下 nodejs 是如何处理 http 的 get 和 post 请求。")]),t._v(" "),s("p",[t._v("我们先新建个 http-test 目录，该目录主要是用做测试 nodejs 代码，现在切换到这个目录")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ mkdir http-test\n$ cd http-test/\n")])])]),s("h3",{attrs:{id:"get-请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-请求"}},[t._v("#")]),t._v(" get 请求")]),t._v(" "),s("ul",[s("li",[t._v("客户端向服务端获取数据，如查询用户信息")]),t._v(" "),s("li",[t._v("通过 querystring 传递数据，如 a.html?id=1&status=1")]),t._v(" "),s("li",[t._v("浏览器输入网址直接访问，就是发送 get 请求")])]),t._v(" "),s("h4",{attrs:{id:"代码示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码示例"}},[t._v("#")]),t._v(" 代码示例")]),t._v(" "),s("p",[t._v("我们新建个 get.js 文件，编辑以下内容。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('const http = require("http")\nconst querystring = require(\'querystring\')\n\nhttp.createServer((request,response)=>{\n    const url =request.url // 获取完整 url\n    console.log("method ",request.method) //GET\n    console.log("url ",url)\n    const query = querystring.parse(url.split("?")[1])// 解析 querystring\n    response.end(JSON.stringify(query));// 把 querystring 返回到页面\n}).listen(3000)\n\nconsole.log(\'Server running at http://127.0.0.1:3000/\');\n')])])]),s("p",[t._v("启动 get.js")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ node get.js\nServer running at http://127.0.0.1:3000/\n")])])]),s("p",[t._v("打开浏览器输入 http://127.0.0.1:3000/user/list?i=1&word=abc")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.guojiang.club/FhrJomTbUVIUuftUeSElPBlEHnES",alt:""}})]),t._v(" "),s("p",[t._v("控制台也打印出了 method 和 url\n"),s("img",{attrs:{src:"https://cdn.guojiang.club/FrZihoo4KqIuJkK52f2S6v9ASYU4",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"post-请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#post-请求"}},[t._v("#")]),t._v(" post 请求")]),t._v(" "),s("ul",[s("li",[t._v("客户端向服务端发送数据，如用户注册")]),t._v(" "),s("li",[t._v("浏览器无法直接模拟 post 请求，需要写 js 代码或通过接口测试工具，比如 postman")])]),t._v(" "),s("p",[t._v("我们新建个 post.js 文件，编辑以下内容。")]),t._v(" "),s("h4",{attrs:{id:"代码示例-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码示例-2"}},[t._v("#")]),t._v(" 代码示例")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("const http = require(\"http\")\n\nhttp.createServer((request,response)=>{\n    if(request.method === \"POST\"){\n        // 数据格式\n        console.log('content-type',request.headers['content-type']);\n        // 接收数据\n        let postData = \"\"\n        // 客户端请求传输数据的时候触发\n        request.on('data',chunk=>{\n            postData += chunk.toString()\n        })\n        // 客户端请求结束的时候触发\n        request.on('end',()=>{\n            console.log(postData)\n            response.end(\"post end ...\")// 异步方法，在这里返回\n        })\n\n    }\n   \n}).listen(3000)\n\nconsole.log('Server running at http://127.0.0.1:3000/');\n")])])]),s("p",[t._v("启动 post.js")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ node post.js\nServer running at http://127.0.0.1:3000/\n")])])]),s("p",[t._v("用 postman 模拟发送 post 请求\n"),s("img",{attrs:{src:"https://cdn.guojiang.club/Fh7Mx7J1QhKs87_9o5drU1XnWDZP",alt:""}}),t._v("\n结果如下")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.guojiang.club/FsdzFOXDzqGlbZtm-1xL6ddOISmu",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"http-请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-请求"}},[t._v("#")]),t._v(" http 请求")]),t._v(" "),s("p",[t._v("现在综合处理 get 和 post 请求，新建个 http.js，编辑以下内容。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("const http = require(\"http\")\nconst querystring = require('querystring')\n\nhttp.createServer((request,response)=>{\n    const url =request.url // 获取完整 url\n    const path = url.split('?')[0]\n    const query = querystring.parse(url.split(\"?\")[1])// 解析 querystring\n    const method = request.method\n\n    // 设置返回格式为 json\n    response.setHeader('content-type','application/json')\n    // 返回的数据\n    const resData = {\n        method,url,path,query\n    }\n    if(method === 'GET'){\n        response.end(JSON.stringify(resData))\n    }\n    if(method === 'POST'){\n        let postData = ''\n        request.on('data',chunk=>{\n            postData += chunk.toString()\n        })\n        request.on('end',()=>{\n            resData.postData = postData\n            response.end(JSON.stringify(resData))\n        })\n    }\n}).listen(3000)\n\nconsole.log('Server running at http://127.0.0.1:3000/');\n")])])]),s("p",[t._v("启动 http.js")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ node post.js\nServer running at http://127.0.0.1:3000/\n")])])]),s("p",[t._v("现在不管是 get 请求还是 post 请求，我们都可以处理了。")]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("今天的内容你掌握了吗？有问题欢迎到群里和志同道合的小伙伴一起交流。")]),t._v(" "),s("p",[t._v("下节课我们开始讲解 callback，promise，async 和 await，继续加油吧，Let's go！")])])}),[],!1,null,null,null);e.default=r.exports}}]);