(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{463:function(a,t,_){"use strict";_.r(t);var v=_(49),s=Object(v.a)({},(function(){var a=this,t=a.$createElement,_=a._self._c||t;return _("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[_("h1",{attrs:{id:"mysql进阶（2）影响mysql性能的因素-3"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#mysql进阶（2）影响mysql性能的因素-3"}},[a._v("#")]),a._v(" mysql进阶（2）影响mysql性能的因素-3")]),a._v(" "),_("h2",{attrs:{id:"mysql-体系结构"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#mysql-体系结构"}},[a._v("#")]),a._v(" MySQL 体系结构")]),a._v(" "),_("p",[_("img",{attrs:{src:"https://tva1.sinaimg.cn/large/a616b9a4gy1g9n00it1fej20fa095tb5.jpg",alt:"image-20191206143225422"}})]),a._v(" "),_("h2",{attrs:{id:"数据库存储引擎"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数据库存储引擎"}},[a._v("#")]),a._v(" 数据库存储引擎")]),a._v(" "),_("h3",{attrs:{id:"myisam"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#myisam"}},[a._v("#")]),a._v(" myisam")]),a._v(" "),_("ul",[_("li",[a._v("mysql5.5 之前版本默认存储引擎")]),a._v(" "),_("li",[a._v("系统表，临时表")]),a._v(" "),_("li",[a._v("表由 MYD 和 MYI 组成")])]),a._v(" "),_("h4",{attrs:{id:"特性"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[a._v("#")]),a._v(" 特性")]),a._v(" "),_("ul",[_("li",[a._v("并发性与锁级别（表锁）")]),a._v(" "),_("li",[a._v("表损坏修复（check/repair table tablename）")]),a._v(" "),_("li",[a._v("支持全文索引")]),a._v(" "),_("li",[a._v("支持数据压缩 （myisampack）")])]),a._v(" "),_("h4",{attrs:{id:"限制"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#限制"}},[a._v("#")]),a._v(" 限制")]),a._v(" "),_("ul",[_("li",[a._v("MySQL 版本<5.0 默认表大小为 4G，存储大表修改 MAX_ROWS 和 AVG_ROW_LENGTH")]),a._v(" "),_("li",[a._v("MySQL 版本》5.0 默认表大小 256TB")])]),a._v(" "),_("h4",{attrs:{id:"适用场景"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#适用场景"}},[a._v("#")]),a._v(" 适用场景")]),a._v(" "),_("ul",[_("li",[a._v("非事务型应用")]),a._v(" "),_("li",[a._v("只读类应用")]),a._v(" "),_("li",[a._v("空间类应用")])]),a._v(" "),_("h3",{attrs:{id:"innodb"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#innodb"}},[a._v("#")]),a._v(" innodb")]),a._v(" "),_("ul",[_("li",[a._v("MySQL5.5 之后的版本默认存储引擎")]),a._v(" "),_("li",[a._v("使用表空间进行数据存储")])]),a._v(" "),_("div",{staticClass:"language-mysql extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[a._v("innodb_file_per_table=ON 独立表空间：tablename.ibd\ninnodb_file_per_table=OFF 系统表空间：ibdataX\n")])])]),_("h4",{attrs:{id:"如何选择系统表空间和独立表空间"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#如何选择系统表空间和独立表空间"}},[a._v("#")]),a._v(" 如何选择系统表空间和独立表空间")]),a._v(" "),_("ul",[_("li",[a._v("系统表空间无非简单收缩文件大小")]),a._v(" "),_("li",[a._v("独立表空间通过 optimize table 命令收缩系统文件")]),a._v(" "),_("li",[a._v("系统表空间会产生 IO 瓶颈")]),a._v(" "),_("li",[a._v("独立表空间可以同时向多个文件刷新数据")]),a._v(" "),_("li",[a._v("优先使用独立表空间")])]),a._v(" "),_("h4",{attrs:{id:"存在系统表空间的表转到独立表空间的方法"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#存在系统表空间的表转到独立表空间的方法"}},[a._v("#")]),a._v(" 存在系统表空间的表转到独立表空间的方法")]),a._v(" "),_("ul",[_("li",[a._v("使用 mysqldump 导出所有数据表数据")]),a._v(" "),_("li",[a._v("停止 MySQL 服务，修改参数，并删除 Innodb 相关文件")]),a._v(" "),_("li",[a._v("重启 MySQL 服务，重建 Innodb 系统表空间")]),a._v(" "),_("li",[a._v("重新导入数据")])]),a._v(" "),_("h4",{attrs:{id:"innodb-存储引擎特性"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#innodb-存储引擎特性"}},[a._v("#")]),a._v(" innodb 存储引擎特性")]),a._v(" "),_("ul",[_("li",[a._v("innodb 是一种事务性存储引擎")]),a._v(" "),_("li",[a._v("完全支持事务 ACID 特性")]),a._v(" "),_("li",[a._v("Redo Log 和 Undo Log")]),a._v(" "),_("li",[a._v("支持行级锁，最大程度支持并发，行级锁由存储引擎层实现")])]),a._v(" "),_("h4",{attrs:{id:"状态检查"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#状态检查"}},[a._v("#")]),a._v(" 状态检查")]),a._v(" "),_("div",{staticClass:"language- extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[a._v("show engin innodb status\n")])])]),_("h4",{attrs:{id:"适用场景-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#适用场景-2"}},[a._v("#")]),a._v(" 适用场景")]),a._v(" "),_("ul",[_("li",[a._v("适合大多数 OLTP 应用")])]),a._v(" "),_("h3",{attrs:{id:"锁"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#锁"}},[a._v("#")]),a._v(" 锁")]),a._v(" "),_("ul",[_("li",[a._v("锁主要作用是管理共享资源的并发访问")]),a._v(" "),_("li",[a._v("锁用于实现事务的隔离性")])]),a._v(" "),_("h4",{attrs:{id:"表级锁"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#表级锁"}},[a._v("#")]),a._v(" 表级锁")]),a._v(" "),_("h4",{attrs:{id:"行级锁"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#行级锁"}},[a._v("#")]),a._v(" 行级锁")]),a._v(" "),_("ul",[_("li",[a._v("独占锁和共享锁")])]),a._v(" "),_("table",[_("thead",[_("tr",[_("th"),a._v(" "),_("th",[a._v("排他锁")]),a._v(" "),_("th",[a._v("共享锁")])])]),a._v(" "),_("tbody",[_("tr",[_("td",[a._v("排他锁")]),a._v(" "),_("td",[a._v("不兼容")]),a._v(" "),_("td",[a._v("不兼容")])]),a._v(" "),_("tr",[_("td",[a._v("共享锁")]),a._v(" "),_("td",[a._v("不兼容")]),a._v(" "),_("td",[a._v("兼容")])])])]),a._v(" "),_("h3",{attrs:{id:"csv"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#csv"}},[a._v("#")]),a._v(" CSV")]),a._v(" "),_("h4",{attrs:{id:"文件系统存储特点"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#文件系统存储特点"}},[a._v("#")]),a._v(" 文件系统存储特点")]),a._v(" "),_("ul",[_("li",[a._v("数据以文本方式存储在文件中")]),a._v(" "),_("li",[a._v(".csv 文件存储表内容")]),a._v(" "),_("li",[a._v(".csm 文件存储表元数据如表状态和数据量")]),a._v(" "),_("li",[a._v(".frm 文件存储表结构信息")])]),a._v(" "),_("h4",{attrs:{id:"特点"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[a._v("#")]),a._v(" 特点")]),a._v(" "),_("ul",[_("li",[a._v("以 CSV 格式进行数据存储")]),a._v(" "),_("li",[a._v("所有列必须是不能为 NULL")]),a._v(" "),_("li",[a._v("不支持索引，不适合在线处理")]),a._v(" "),_("li",[a._v("可以对数据文件直接编辑")])]),a._v(" "),_("h4",{attrs:{id:"适用场景-3"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#适用场景-3"}},[a._v("#")]),a._v(" 适用场景")]),a._v(" "),_("ul",[_("li",[a._v("适合做数据交换的中间表")])]),a._v(" "),_("h3",{attrs:{id:"archive"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#archive"}},[a._v("#")]),a._v(" Archive")]),a._v(" "),_("h4",{attrs:{id:"文件系统存储特点-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#文件系统存储特点-2"}},[a._v("#")]),a._v(" 文件系统存储特点")]),a._v(" "),_("ul",[_("li",[a._v("以 zlib 对表数据进行压缩，磁盘 IO 更少")]),a._v(" "),_("li",[a._v("数据存储在 ARZ 为后缀的文件中")])]),a._v(" "),_("h4",{attrs:{id:"特点-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#特点-2"}},[a._v("#")]),a._v(" 特点")]),a._v(" "),_("ul",[_("li",[a._v("只支持 insert 和 select 操作")]),a._v(" "),_("li",[a._v("只允许在自增 ID 上加索引")])]),a._v(" "),_("h4",{attrs:{id:"适用场景-4"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#适用场景-4"}},[a._v("#")]),a._v(" 适用场景")]),a._v(" "),_("ul",[_("li",[a._v("日志和数据采集类应用")])]),a._v(" "),_("h3",{attrs:{id:"memory"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#memory"}},[a._v("#")]),a._v(" Memory")]),a._v(" "),_("h4",{attrs:{id:"文件系统存储特点-3"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#文件系统存储特点-3"}},[a._v("#")]),a._v(" 文件系统存储特点")]),a._v(" "),_("ul",[_("li",[a._v("也称 Heap 存储引擎，所以数据保存在内存中")])]),a._v(" "),_("h4",{attrs:{id:"特点-3"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#特点-3"}},[a._v("#")]),a._v(" 特点")]),a._v(" "),_("ul",[_("li",[a._v("支持 hash 索引和 btree 索引")]),a._v(" "),_("li",[a._v("所有字段都是固定长度")]),a._v(" "),_("li",[a._v("不支持 blog 和 text 字段")]),a._v(" "),_("li",[a._v("使用表级锁")]),a._v(" "),_("li",[a._v("表最大大小由 max_heap_table_size 参数决定")])]),a._v(" "),_("h4",{attrs:{id:"适用场景-5"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#适用场景-5"}},[a._v("#")]),a._v(" 适用场景")]),a._v(" "),_("ul",[_("li",[a._v("用于查找或者映射表，例如邮编和地区对应表")]),a._v(" "),_("li",[a._v("用于保存数据分析中产生的中间表")]),a._v(" "),_("li",[a._v("用于缓存周期性聚合数据结果表")]),a._v(" "),_("li",[a._v("数据易丢失，要求数据可再生")])]),a._v(" "),_("h3",{attrs:{id:"federated"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#federated"}},[a._v("#")]),a._v(" Federated")]),a._v(" "),_("h4",{attrs:{id:"特点-4"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#特点-4"}},[a._v("#")]),a._v(" 特点")]),a._v(" "),_("ul",[_("li",[a._v("提供访问远程 MySQL 服务器上表的方法")]),a._v(" "),_("li",[a._v("本地不存储数据，数据全部放到远程服务器上")]),a._v(" "),_("li",[a._v("本地需要保存表结构和远程服务器连接信息")])]),a._v(" "),_("h4",{attrs:{id:"如何使用"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#如何使用"}},[a._v("#")]),a._v(" 如何使用")]),a._v(" "),_("ul",[_("li",[a._v("默认禁止，启用需要在启动时候增加 federated 参数")])]),a._v(" "),_("div",{staticClass:"language- extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[a._v("mysql://user_name[:password]@host_name[:port]/db_name/table_name\n")])])]),_("h4",{attrs:{id:"适用场景-6"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#适用场景-6"}},[a._v("#")]),a._v(" 适用场景")]),a._v(" "),_("ul",[_("li",[a._v("偶尔的统计分析和手工查询")])]),a._v(" "),_("h3",{attrs:{id:"如何选择正确存储引擎"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#如何选择正确存储引擎"}},[a._v("#")]),a._v(" 如何选择正确存储引擎")]),a._v(" "),_("ul",[_("li",[a._v("是否需要事务支持")]),a._v(" "),_("li",[a._v("备份选择")]),a._v(" "),_("li",[a._v("崩溃恢复")]),a._v(" "),_("li",[a._v("存储引擎特性")]),a._v(" "),_("li",[a._v("不要混合使用存储引擎")])]),a._v(" "),_("h2",{attrs:{id:"欢迎扫描下方二维码，个人博客，持续关注："}},[_("a",{staticClass:"header-anchor",attrs:{href:"#欢迎扫描下方二维码，个人博客，持续关注："}},[a._v("#")]),a._v(" 欢迎扫描下方二维码，"),_("a",{attrs:{href:"https://www.phpst.cn",target:"_blank",rel:"noopener noreferrer"}},[a._v("个人博客"),_("OutboundLink")],1),a._v("，持续关注：")]),a._v(" "),_("p",[_("img",{attrs:{src:"https://ww1.sinaimg.cn/large/a616b9a4gy1g4xzv954a4j20760763yo.jpg",alt:""}})]),a._v(" "),_("p",[a._v("互联网工程师（id:phpstcn），我们一起学习，一起进步")])])}),[],!1,null,null,null);t.default=s.exports}}]);